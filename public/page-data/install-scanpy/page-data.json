{"componentChunkName":"component---src-pages-markdown-remark-fields-slug-js","path":"/install-scanpy/","result":{"data":{"markdownRemark":{"html":"<p>Apple decided to change the architecture of their processor. They use ARM chips that they develop in-house. This change comes with some trade-off for python programming especially in the data science world. I had to use some data science and bioinformatic libraries and faced issues regarding their installation. The most notable one was with the library scanpy. First the library needs some system dependencies. Second, these some Python libraries that are just not available yet for the ARM chips. Indeed their wheels is still note ready to be used on PyPi. Here I kept note to remember the steps needed for the installation of scanpy. For managing my environments I use <code>poetry</code>, <code>conda</code> or <code>pipenv</code>. Unfortunately I did not manage to install Scanpy via <code>pip</code> depedent package managers (both <code>pipenv</code> or <code>poetry</code> do not work). The only alternative that worked was<code>conda</code>. But to be operational, you first need to install and configure some dependencies.</p>\n<h2 id=\"hdf5\" style=\"position:relative;\"><a href=\"#hdf5\" aria-label=\"hdf5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HDF5</h2>\n<p>HDF5 is a high performance data software library and file format to manage, process, and store your heterogeneous data. HDF5 is built for fast I/O processing and storage. Scanpy can read and store AnnData object as <code>h5ad</code> files that are <code>hdf5</code> files with some additional structure specifying how to store AnnData objects. To install it you will need homebrew on your Mac M1 machine.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">brew <span class=\"token function\">install</span> hdf5\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">HDF5_DIR</span><span class=\"token operator\">=</span>/opt/homebrew/Cellar/hdf5/1.12.1 <span class=\"token comment\"># use the version you have</span></code></pre></div>\n<h2 id=\"llvmlite\" style=\"position:relative;\"><a href=\"#llvmlite\" aria-label=\"llvmlite permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>LLVMLITE</h2>\n<p>Next install <code>llvmlite</code> with homebrew. <code>llvmlite</code> provides a Python binding to LLVM for use in Numba that translates a subset of Python and NumPy code into fast machine code. It is extensively used in Scanpy given its dependency to numpy and scikit-learn.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">brew <span class=\"token function\">install</span> llvm@11</code></pre></div>\n<p>Make sure <code>/opt/homebrew/opt/llvm@11/bin</code> is in your path. For that edit the <code>/etc/paths</code> to add this path. Next install <code>llvmlite</code> in your python environment.</p>\n<h2 id=\"conda\" style=\"position:relative;\"><a href=\"#conda\" aria-label=\"conda permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conda</h2>\n<p>I recommend installing Miniconda. Miniconda is essentially an installer for an empty conda environment, containing only Conda, its dependencies, and Python.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">conda config <span class=\"token parameter variable\">--add</span> channels defaults\nconda config <span class=\"token parameter variable\">--add</span> channels bioconda\nconda config <span class=\"token parameter variable\">--add</span> channels conda-forge\nconda config <span class=\"token parameter variable\">--set</span> offline <span class=\"token boolean\">false</span></code></pre></div>\n<p>Once done, you can install <code>scanpy</code> in your machine.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> scanpy</code></pre></div>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>It was a short one, but it will be, for sure, a good reminder for my future <code>scanpy</code> projects when working in a Mac M1. I hope that in the future these issues will be solved. In the mean time, I still use my Linux computer when I need to deal with Scanpy. There, everything works out of the box with classical <code>pip install</code>.</p>\n<h2 id=\"update\" style=\"position:relative;\"><a href=\"#update\" aria-label=\"update permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Update</h2>\n<p>Since Numba 0.55.2 and llvmlite 0.38.1 are now available with wheels from PyPi you can now easily install <code>scanpy</code> on your mac M1. You can see the thread <a href=\"https://numba.discourse.group/t/wheels-for-apple-silicon-m1/1282\">here</a> to have more context about it.</p>","frontmatter":{"title":"Installation of Scanpy on a Mac M1","date":"February 10, 2022","tags":["Python","Bioinformatics"]}}},"pageContext":{"id":"54c29b74-020b-586b-8040-940333020228","fields__slug":"/install-scanpy/","__params":{"fields__slug":"install-scanpy"}}},"staticQueryHashes":["2750728228"],"slicesMap":{}}