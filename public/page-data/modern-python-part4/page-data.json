{"componentChunkName":"component---src-pages-markdown-remark-fields-slug-js","path":"/modern-python-part4/","result":{"data":{"markdownRemark":{"html":"<p>In three previous articles, I presented one possible flow to work with Python projects. After two years of professional experience I'd like to elaborate on some points.</p>\n<h2 id=\"managing-python-environments\" style=\"position:relative;\"><a href=\"#managing-python-environments\" aria-label=\"managing python environments permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Managing python environments</h2>\n<p>My advise for juniors would be to build projects using different tools: <code>pip</code>, <code>poetry</code>, <code>conda</code> or others. Diversify your technical toolset. I focused on <code>poetry</code> for my article series but be aware that your company might not use the last fancy open source tools to manage your python environments and packages. Right now at my company, I am using <code>miniconda</code> for managing python environments and <code>pip</code> + <code>requirements-*.txt</code> files for package management. Note the wildcard <code>*</code>. We use different suffixes to specify the type of coding environments the packages are needed for.</p>\n<ul>\n<li>Our <code>requirements.txt</code> file catalogs libraries strictly required to use your package / code.</li>\n<li>Our <code>requirements-dev.txt</code> file catalogs libraries required for your developer environment for testing testing or linting your code.</li>\n<li>Our <code>requirements-ci.txt</code> file catalogs libraries required to inject when building some of of docker images for continuous integration.</li>\n</ul>\n<h2 id=\"testing-your-code-will-save-you-a-lot-of-time\" style=\"position:relative;\"><a href=\"#testing-your-code-will-save-you-a-lot-of-time\" aria-label=\"testing your code will save you a lot of time permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testing your code will save you a lot of time</h2>\n<p>We all heard this sentence one time in our engineer life: \"testing your code is critical\". But between the theory and the reality, there is a huge gap. I have seen codebases with almost zero test in very different environments (banking, academia, startups). I also faced the situation where I was kindly advised not to spend to much time writing tests as this may alter my velocity on tightly budgeted projects. This is really a pity. Now, I am working on codebases highly covered by both unit and integration tests. Having experienced both situations, I can guarantee you that testing your code WILL SAVE YOU a lot of time. This is a long-term investment that your future self or colleague will bless. With tests you can easily spend time refactoring your code, add new features without any fear and this is priceless.</p>\n<p>Along the way I learnt new testing pattern with <code>pytest</code>. On my previous articles I focused on <code>fixtures</code> to reuse pieces of data or code. But since, I learnt to parametrize my testing functions with <code>pytest.mark.parametrize</code> and also \"monkey patch\" some piece of code with the <code>monkeypatch</code> pytest fixture. Drill these if you can.</p>\n<h2 id=\"pre-commit-is-the-king\" style=\"position:relative;\"><a href=\"#pre-commit-is-the-king\" aria-label=\"pre commit is the king permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code>pre-commit</code> is the king</h2>\n<p>I am using <code>pre-commit</code> for all our company projects. Clearly having it installed is a must. With a proper list of <code>pre-commit</code> tasks you will always ship good quality code when pushing your commits. Be aware that the <code>pre-commit</code> you install may depend on your company / team guidelines in term of code quality. A typical <code>.pre-commit-config.yaml</code> file looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">repos</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">repo</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//github.com/pre<span class=\"token punctuation\">-</span>commit/pre<span class=\"token punctuation\">-</span>commit<span class=\"token punctuation\">-</span>hooks\n    <span class=\"token key atrule\">rev</span><span class=\"token punctuation\">:</span> v4.3.0\n    <span class=\"token key atrule\">hooks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> trailing<span class=\"token punctuation\">-</span>whitespace\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> end<span class=\"token punctuation\">-</span>of<span class=\"token punctuation\">-</span>file<span class=\"token punctuation\">-</span>fixer\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> check<span class=\"token punctuation\">-</span>yaml\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> check<span class=\"token punctuation\">-</span>json\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> check<span class=\"token punctuation\">-</span>case<span class=\"token punctuation\">-</span>conflict\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> check<span class=\"token punctuation\">-</span>builtin<span class=\"token punctuation\">-</span>literals\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> check<span class=\"token punctuation\">-</span>docstring<span class=\"token punctuation\">-</span>first\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> check<span class=\"token punctuation\">-</span>merge<span class=\"token punctuation\">-</span>conflict\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> debug<span class=\"token punctuation\">-</span>statements\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> requirements<span class=\"token punctuation\">-</span>txt<span class=\"token punctuation\">-</span>fixer\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> detect<span class=\"token punctuation\">-</span>private<span class=\"token punctuation\">-</span>key\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> pretty<span class=\"token punctuation\">-</span>format<span class=\"token punctuation\">-</span>json\n        <span class=\"token key atrule\">args</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"--autofix\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"--indent\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"4\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"--no-sort-keys\"</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">repo</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//github.com/adrienverge/yamllint.git\n    <span class=\"token key atrule\">rev</span><span class=\"token punctuation\">:</span> v1.28.0\n    <span class=\"token key atrule\">hooks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> yamllint\n\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">repo</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//github.com/asottile/pyupgrade\n    <span class=\"token key atrule\">rev</span><span class=\"token punctuation\">:</span> v2.38.0\n    <span class=\"token key atrule\">hooks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> pyupgrade\n        <span class=\"token key atrule\">args</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"--py3-plus\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"--py39-plus\"</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">repo</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//github.com/psf/black\n    <span class=\"token key atrule\">rev</span><span class=\"token punctuation\">:</span> 22.8.0\n    <span class=\"token key atrule\">hooks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> black\n\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">repo</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//github.com/PyCQA/isort\n    <span class=\"token key atrule\">rev</span><span class=\"token punctuation\">:</span> 5.10.1\n    <span class=\"token key atrule\">hooks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> isort\n        <span class=\"token key atrule\">args</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"--profile\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">repo</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//github.com/pycqa/flake8\n    <span class=\"token key atrule\">rev</span><span class=\"token punctuation\">:</span> 5.0.4\n    <span class=\"token key atrule\">hooks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> flake8\n        <span class=\"token key atrule\">args</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"--max-line-length\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"88\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"--ignore\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"E203,W50,E501\"</span><span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">additional_dependencies</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>flake8<span class=\"token punctuation\">-</span>bugbear<span class=\"token punctuation\">]</span>\n\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">repo</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//github.com/PyCQA/bandit\n    <span class=\"token key atrule\">rev</span><span class=\"token punctuation\">:</span> 1.7.4\n    <span class=\"token key atrule\">hooks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> bandit\n        <span class=\"token comment\"># .bandit config is not read when used by</span>\n        <span class=\"token comment\"># pre-commit (ie with explicit file in input)</span>\n        <span class=\"token comment\"># https://github.com/PyCQA/bandit/issues/332</span>\n        <span class=\"token key atrule\">args</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"--skip\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"B101\"</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">repo</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//github.com/pre<span class=\"token punctuation\">-</span>commit/mirrors<span class=\"token punctuation\">-</span>mypy\n    <span class=\"token key atrule\">rev</span><span class=\"token punctuation\">:</span> v0.971\n    <span class=\"token key atrule\">hooks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> mypy\n        <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>python<span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">args</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"--ignore-missing-imports\"</span><span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">additional_dependencies</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">[</span>pydantic<span class=\"token punctuation\">,</span> types<span class=\"token punctuation\">-</span>pytz<span class=\"token punctuation\">,</span> types<span class=\"token punctuation\">-</span>requests<span class=\"token punctuation\">,</span> types<span class=\"token punctuation\">-</span>protobuf<span class=\"token punctuation\">]</span></code></pre></div>\n<p>All of the above-mentionned checks will be run each before each commit. If your code does not comply to the rules enforced by any of them, your code will not be commited to your repository.</p>\n<h2 id=\"really-learn-git\" style=\"position:relative;\"><a href=\"#really-learn-git\" aria-label=\"really learn git permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Really learn <code>GIT</code></h2>\n<p>This one is pretty trivial. But I really advise you to learn git and understand how it works under the hood. Do not embrace its complexity but rather focus on the mechanism. Once you realized that what <code>git</code> does is mainly writing hashed content with pointers on your computer, you may apprehend it differently, without fear and hesitation. Watch this <a href=\"https://www.youtube.com/watch?v=lG90LZotrpo\">video</a>. It gave me a lot of these <code>AHAAAAA</code> moments and made me feel smarter. Knowing how to rebase, rolling back to specific <code>reflogs</code> will save you at your job and most importantly, your colleagues will trust you and give you more responsibility not fearing you may break / re-write history.</p>\n<h2 id=\"makefile-for-automation\" style=\"position:relative;\"><a href=\"#makefile-for-automation\" aria-label=\"makefile for automation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Makefile for automation</h2>\n<p>There are a lot of redundant tasks that I am doing on a daily basis:</p>\n<ul>\n<li>testing your code</li>\n<li>running your code against your linters / formaters</li>\n<li>building container images</li>\n<li>deploying resources on cloud using the provider CLI</li>\n</ul>\n<p>I tend to automate all of them using <code>Makefile</code> rules. It works and save me a lot of time.</p>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>My main objective here was to give some kind of feedback based on my own experience as a python engineer. Cultures are different across company and there is no absolute workflow to learn. Nevertheless, there are some foundations that need to be here if you want your life as a developer to be productive. Testing your code is a game changer for me. During interview ask recruiters questions about their software engineering culture. This is super important especially if you want to work on high quality coding environment.</p>","frontmatter":{"title":"Modern Python part 4: facing reality","date":"January 03, 2023","tags":["Python","Github","DevOps"]}}},"pageContext":{"id":"a1f0de2a-d7be-5390-8951-0ca245270994","fields__slug":"/modern-python-part4/","__params":{"fields__slug":"modern-python-part4"}}},"staticQueryHashes":["2750728228"],"slicesMap":{}}